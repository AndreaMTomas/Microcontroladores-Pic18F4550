#include p18f4550.inc                
   CBLOCK 0X20
      VALOR1
      VALOR2
   ENDC
 
   ORG	0X00; DIRECCION 0
   
CONF
   CLRF	TRISD; PUERTO D -> SALIDA
   ; PUERTO B -> ENTRADA
   MOVLW 0XFF
   MOVWF TRISB  
   MOVWF TRISC
   ; TODOS PINES A DIGITALES
   MOVLW	0X0F
   MOVWF	ADCON1
   CLRF LATD
   CLRF LATB

INICIO	
PARTE_BAJA
	;========== PARTE BAJA DE BITS ===========
	MOVF PORTB, W
	MOVWF 0X20	; GUARDARLO EN 0X20
	MOVLW 0X0F	; 0 0 0 0 1 1 1 1 SEGUNDA MASCARA
	ANDWF 0X20, W
	MOVWF 0X20
	MOVWF VALOR1
	;MOVWF LATD
	
PARTE_ALTA
	; F = 1 Y W = 0
	MOVF PORTB, W
	MOVWF 0X22
	; ========== PARTE ALTA DE BITS ===========
	MOVLW 0XF0 ; 1 1 1 1 0 0 0 0 (240)
	ANDWF 0X22, W	; AND CON LO GUARDADO EN W Y GUARDARLO EN W
	MOVWF 0X21	; GUARDARLO EN LA DIRECCION 0X21
	RRNCF 0X21, F	; PRIMERA ROTACION
	RRNCF 0X21, F	; SEGUNDA ROTACION
	RRNCF 0X21, F	; TERCERA ROTACION
	RRNCF 0X21, F	; CUARTA ROTACION
	MOVF 0X21, W
	MOVWF VALOR2
	
COMPARAR
	CLRF PORTB
	MOVF VALOR2, W
	CPFSGT VALOR1
	BRA VALOR2_MAYOR;V2 ES MAYOR
	BRA VALOR1_MAYOR;V1 ES MAYOR
	 
VALOR2_MAYOR
	MOVF VALOR2, W
	ADDWF VALOR2, W
	CALL TABLA
	MOVWF LATD
	GOTO INICIO 
	
VALOR1_MAYOR
	MOVF VALOR1, W
	ADDWF VALOR1, W
	CALL TABLA
	MOVWF LATD
	GOTO INICIO
	
TABLA 
	ADDWF PCL, F
	RETLW 0X3F	;0
	RETLW 0X06	;1
	RETLW 0X5B	;2
	RETLW 0X4F	;3
	RETLW 0X66	;4
	RETLW 0X6D	;5
	RETLW 0X7D	;6
	RETLW 0X07	;7
	RETLW 0X7F	;8
	RETLW 0X67	;9
	RETLW 0X77	;A
	RETLW 0X7C	;B
	RETLW 0X39	;C
	RETLW 0X5E	;D
	RETLW 0X79	;E
	RETLW 0X71	;F
END
